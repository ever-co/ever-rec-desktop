@let audios = audios$ | async;

<!-- Is Available -->
@let currentAudio = currentAudio$ | async;

<!-- playing -->
@let isPlaying = isPlaying$ | async;

<!-- progress -->
@let progress = progressPercentage$ | async;

<!-- current time -->
@let currentTime = currentTimeFormatted$ | async;

<!-- duration -->
@let duration = durationFormatted$ | async;

<!-- Available -->

@if (isAvailable$ | async) {
<div
  class="flex"
  [ngClass]="{
    'flex-col-reverse': layoutService.isMobileView(),
    'gap-2': !layoutService.isMobileView(),
    'gap-4': layoutService.isMobileView()
  }"
>
  <div
    libInfiniteScroll
    (scrolled)="moreAudios()"
    class="grid grid-cols-1 static gap-4 overflow-auto max-h-custom main"
    [ngClass]="{ 'pr-4': !layoutService.isMobileView() }"
  >
    @for (audio of audios; track audio.id) {
    <!-- Check if the audio is selected -->
    @let isSelected = audio.id === currentAudio?.id;
    <!-- Get duration -->
    @let audioDuration = audio?.metadata?.duration| humanize : 's' : 'mm:ss' : {
    trim: false };
    <!-- Check if the audio is playing -->
    <lib-audio-inline
      class="card"
      [audio]="audio"
      [isPlaying]="isPlaying && isSelected"
      [progress]="isSelected ? progress : 0"
      [currentTime]="isSelected ? currentTime : '00:00'"
      [duration]="isSelected ? duration : audioDuration"
      (playPause)="synchronize(audio)"
    ></lib-audio-inline>
    }
  </div>
  <div>
    @if(currentAudio) {
    <lib-audio-player-container
      [audio]="currentAudio"
      [mode]="mode"
      class="card"
    ></lib-audio-player-container>
    }
  </div>
</div>

@if((size$ | async)) {
<div class="absolute inset-x-0 action-button-group">
  <lib-gallery-buttons-action
    [buttons]="actionButtons"
    [size]="size$ | async"
    [data]="selectedAudios$ | async"
  ></lib-gallery-buttons-action>
</div>
} } @else {
<div class="flex h-full items-center p-4 justify-center">
  <lib-no-data message="No audios available" class="text-center text-gray-500">
  </lib-no-data>
</div>
}
