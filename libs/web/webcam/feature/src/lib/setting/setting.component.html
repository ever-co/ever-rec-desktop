@let cameras = cameras$ | async; @let microphones = microphones$ | async;

<div class="setting max-w-xl space-y-6 w-full">
  <form [formGroup]="formGroup" class="form space-y-4" (ngSubmit)="onSubmit()">
    <!-- Toggle for tracking -->
    <div class="start flex justify-between items-center">
      <span class="text-gray-700">Record audio while tracking</span>
      <mat-slide-toggle formControlName="audioRecord"> </mat-slide-toggle>
    </div>

    <!-- Select Input -->
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Available Microphones</mat-label>
      <mat-select formControlName="microphone" required>
        @for (micro of microphones; track micro.deviceId) {
        <mat-option [value]="micro.deviceId">{{ micro.label }}</mat-option>
        }
      </mat-select>
      @if (formGroup.controls['microphone'].hasError('required')) {
      <mat-error>Please select a microphone source</mat-error>
      }
    </mat-form-field>
    <!-- Toggle for tracking -->
    <div class="start flex justify-between items-center">
      <span class="text-gray-700"
        >Take camera shot with screenshot while tracking</span
      >
      <mat-slide-toggle formControlName="tracking"> </mat-slide-toggle>
    </div>

    <!-- Select Input -->
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Available Camera</mat-label>
      <mat-select formControlName="webcam" required>
        @for (camera of cameras; track camera.deviceId) {
        <mat-option [value]="camera.deviceId">{{ camera.label }}</mat-option>
        }
      </mat-select>
      @if (formGroup.controls['webcam'].hasError('required')) {
      <mat-error>Please select a camera source</mat-error>
      }
    </mat-form-field>

    <!-- Select Input -->
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Resolution</mat-label>
      <mat-select formControlName="resolution" required>
        @for (resolution of resolutions; track resolution) {
        <mat-option [value]="resolution">{{
          resolution | titlecase
        }}</mat-option>
        }
      </mat-select>
      @if (formGroup.controls['resolution'].hasError('required')) {
      <mat-error>Please select resolution</mat-error>
      }
    </mat-form-field>

    <!-- Preview -->
    <div class="flex flex-col gap-4">
      <div class="start flex justify-between items-center">
        <span class="text-gray-700">Check camera (Optional)</span>
        <mat-slide-toggle formControlName="checkCamera"> </mat-slide-toggle>
      </div>

      @if (formGroup.controls['checkCamera'].value) {
      <router-outlet></router-outlet>
      }
    </div>

    <!-- Submit Buttons -->
    <div class="flex space-x-4">
      <button
        mat-stroked-button
        color="primary"
        type="submit"
        [disabled]="formGroup.invalid"
      >
        Save
      </button>
    </div>
  </form>
</div>
