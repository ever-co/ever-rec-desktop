@if (screenshot$ | async; as screenshot) {
<div class="max-w-7xl mx-auto bg-white rounded-df overflow-auto max-h-custom">
  <div class="flex flex-col lg:flex-row">
    <!-- Screenshot Display Section -->
    <div class="w-full lg:w-2/3 p-4">
      <div
        class="rounded-df overflow-hidden bg-gray-800 relative w-full h-full flex items-center justify-center transform transition-transform duration-300 scale-[0.99] hover:scale-[1.00]"
      >
        <img
          [src]="screenshot.pathname"
          alt="Screenshot"
          class="max-w-full max-h-full rounded-df shadow-lg"
          libImgFallback
        />
        <div
          class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-df opacity-0 hover:opacity-100 transition-opacity duration-300"
        >
          <div class="p-4 space-y-2">
            <a
              [href]="screenshot.pathname"
              rel="noopener"
              target="_blank"
              class="text-white absolute top-2 right-2"
            >
              <button mat-icon-button color="primary" aria-label="open_in_new">
                <mat-icon>open_in_new</mat-icon>
              </button>
            </a>
          </div>
          <div class="p-4 space-y-2">
            <button
              class="text-white absolute top-2 left-2"
              mat-icon-button
              color="primary"
              aria-label="arrow_back"
              (click)="goBack()"
            >
              <mat-icon>arrow_back</mat-icon>
            </button>
          </div>
        </div>
      </div>
      <div class="mt-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
          @for(chunk of screenshot.chunks; track chunk.id) {
          <div
            (click)="load(chunk.id)"
            class="overflow-hidden cursor-pointer rounded-df shadow-md hover:shadow-lg transition-shadow duration-300"
          >
            <img
              [src]="chunk.pathname"
              alt="Screenshot chunk"
              class="w-full h-auto hover:scale-105 object-cover"
              libImgFallback
            />
          </div>
          }
        </div>
      </div>
    </div>

    <!-- Metadata Section -->
    <div class="w-full flex flex-col gap-4 lg:w-1/3 bg-gray-100 p-4">
      <div class="flex items-start gap-4">
        @if(screenshot?.metadata?.application?.icon) {
        <img
          libIconFallback
          [src]="screenshot?.metadata?.application?.icon"
          [alt]="screenshot?.metadata?.application?.name"
          class="w-12 h-12"
        />
        }
        <div class="flex-grow">
          @if(screenshot?.metadata?.application?.name) {
          <div class="text-xl font-bold text-gray-800 mb-1">
            {{ screenshot?.metadata?.application?.name }}
          </div>
          }
          <div class="text-sm text-gray-600 flex items-center flex-wrap">
            <span class="mr-2">{{
              screenshot.createdAt | utcToLocalTime
            }}</span>
            <span class="text-gray-400 mr-2">â€¢</span>
            <span>{{ screenshot?.metadata?.size | humanizeBytes }}</span>
          </div>
        </div>
        <button
          [libPopover]="menu"
          mat-icon-button
          class="text-gray-500 hover:text-gray-700 transition-colors"
        >
          <mat-icon>more_vert</mat-icon>
        </button>
      </div>

      @if(screenshot?.metadata?.description) {
      <div class="bg-white rounded-df p-4">
        <div class="flex items-center justify-between mb-2">
          <div>Description</div>
          <div
            [libCopyToClipboard]="screenshot?.metadata?.description || ''"
            class="text-lg font-semibold text-gray-700"
          ></div>
        </div>
        <p class="text-gray-600">{{ screenshot?.metadata?.description }}</p>
      </div>
      } @if(screenshot.video; as video) {
      <div class="bg-white rounded-df p-4">
        <div class="text-lg font-semibold text-gray-600 mb-2">
          Associated Video
        </div>
        <lib-video
          class="w-full rounded-df overflow-hidden"
          [video]="video"
        ></lib-video>
      </div>
      }
    </div>
  </div>
</div>

<ng-template #menu>
  <lib-action-button-group
    [data]="screenshot"
    [buttons]="actionButtons"
  ></lib-action-button-group>
</ng-template>
} @else {
<div
  class="min-h-screen flex justify-center items-center bg-gradient-to-br from-gray-50 to-gray-100"
>
  <div class="bg-white p-8 rounded-df shadow-xl">
    <lib-no-data
      class="text-gray-700"
      message="No screenshot available"
    ></lib-no-data>
  </div>
</div>
}
